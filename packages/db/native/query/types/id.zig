const db = @import("../../db/db.zig");
const selva = @import("../../selva.zig");
const getFields = @import("../include/include.zig").getFields;
const results = @import("../results.zig");
const QueryCtx = @import("../ctx.zig").QueryCtx;
const filter = @import("../filter/filter.zig").filter;

pub fn default(
    id: u32,
    ctx: *QueryCtx,
    typeId: db.TypeId,
    conditions: []u8,
    include: []u8,
) !void {
    const typeEntry = try db.getType(ctx.db, typeId);
    const node = db.getNode(id, typeEntry);
    if (node == null) {
        return;
    }
    if (!filter(ctx.db, node.?, typeEntry, conditions, null, null, 0, false)) {
        return;
    }
    const size = try getFields(
        node.?,
        ctx,
        id,
        typeEntry,
        include,
        null,
        null,
        false,
    );
    if (size > 0) {
        ctx.size += size;
        ctx.totalResults += 1;
    }
}
